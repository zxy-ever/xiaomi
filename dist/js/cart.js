"use strict";var token=localStorage.getItem("token"),username=JSON.parse(localStorage.getItem("username"));function isEmpty(){var t=JSON.parse(localStorage.getItem("cart"));t&&0!=t.length?($(".empty").hide(),$(".cartList").show(),$(".header .header_title > p").show()):($(".empty").show(),$(".cartList").hide(),$(".header .header_title > p").hide())}function getList(){var t=localStorage.getItem("cart");if(t){var e=JSON.parse(t),c="";e.forEach(function(t){c+='\n            <div class="cart_box clean">\n                <div class="cart-check fl">\n                    <input type="checkbox" class="checkSingle">\n                </div>\n                <div class="cart-img fl">\n                    <img src="'.concat(t.pc_img,'"\n                        alt="">\n                </div>\n                <div class="cart-name fl">').concat(t.goods_name,'</div>\n                <div class="cart-price fl">\n                    <i class="price">').concat(t.goods_price,'</i>\n                    元</div>\n                <div class="cart-num fl">\n                    <input type="button" onclick="subClick(this,').concat(t.goods_id,')" class="subBtn fl" value="-">\n                    <input type="text" class="num fl" value="').concat(t.pnum,'">\n                    <input type="button" onclick="addClick(this,').concat(t.goods_id,')" class="addBtn fl" value="+">\n                </div>\n                <div class="cart-total fl">\n                    <i class="total"></i>\n                    元</div>\n                <div class="cart-action fl">\n                    <input type="button" onclick="delClick(this,').concat(t.goods_id,')" class="delBtn" value="×">\n                </div>\n            </div>\n            ')}),$(".cart_list").html(c)}}function getTotalNum(){var t=localStorage.getItem("cart"),e=JSON.parse(t),c=0;e.forEach(function(t){c+=t.pnum}),$(".cartNum").html(c)}function subTotal(){$(".total").each(function(t,e){var c=Number($(e).parent().siblings(".cart-num").children(".num").val()),a=Number($(e).parent().siblings(".cart-price").children(".price").html());$(e).html(c*a)})}function getCount(){var n=0,l=0;$(".checkSingle").each(function(t,e){if($(e).prop("checked")){var c=Number($(e).parent().siblings(".cart-num").children(".num").val()),a=Number($(e).parent().siblings(".cart-price").children(".price").html());n+=c,l+=c*a}}),$(".selNum").html(n),$(".totalPrice").html(l)}function addClick(t,e){var c=JSON.parse(localStorage.getItem("cart")),a=c.find(function(t){return t.goods_id==e});a.pnum++,$(t).prev().val(a.pnum),localStorage.setItem("cart",JSON.stringify(c)),getCount(),subTotal(),getTotalNum()}function subClick(t,e){var c=JSON.parse(localStorage.getItem("cart")),a=c.find(function(t){return t.goods_id==e});1!=a.pnum&&(a.pnum--,$(t).next().val(a.pnum),localStorage.setItem("cart",JSON.stringify(c)),getCount(),subTotal(),getTotalNum())}function delClick(t,e){var c=JSON.parse(localStorage.getItem("cart")).filter(function(t){return t.goods_id!=e});$(t).parent().parent().remove(),localStorage.setItem("cart",JSON.stringify(c)),isEmpty(),getCount(),subTotal(),getTotalNum()}function getState(){var t=document.querySelectorAll(".checkSingle");1==Array.from(t).some(function(t){return 1==t.checked})?$(".pay").removeAttr("disabled").css({background:"#ff7600",color:"#fff"}):$(".pay").attr("disabled","disabled").css({background:"#e0e0e0",color:"#b0b0b0"})}token?($(".already").show(),$(".login").hide(),$(".already .username").html(username),$(".loginBtn").hide(),$(".listBtn").addClass("listBtnAlready")):($(".already").hide(),$(".login").show(),$(".loginBtn").show(),$(".listBtn").removeClass("listBtnAlready")),isEmpty(),getList(),$(".checkAll").click(function(){var t=$(this).prop("checked");$(".checkSingle").prop("checked",t),getCount(),getState()}),$(".cart_list").on("click",".checkSingle",function(){var c=!0;$(".checkSingle").each(function(t,e){e.checked||(c=!1)}),$(".checkAll").prop("checked",c),getCount(),getState()}),getTotalNum(),subTotal(),getCount(),$(".exit").click(function(){localStorage.removeItem("token")});